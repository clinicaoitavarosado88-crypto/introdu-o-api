{
	"info": {
		"_postman_id": "buscar-convenios-api-2025",
		"name": "Buscar Convênios API",
		"description": "Collection para testar o endpoint de busca de convênios da Clínica Oitava.\n\n**Funcionalidades:**\n- Busca por nome do convênio (apenas os que começam com o termo)\n- Busca por ID do convênio\n- Retorna informações sobre sindicato\n- Corrige encoding automático para UTF-8\n- **Convênios suspensos não são retornados**",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Buscar Convênio por Nome",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code é 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Resposta é JSON\", function () {",
							"    pm.response.to.be.json;",
							"});",
							"",
							"pm.test(\"Retorna array de results\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData).to.have.property('results');",
							"    pm.expect(jsonData.results).to.be.an('array');",
							"});",
							"",
							"pm.test(\"Resultados têm estrutura correta\", function () {",
							"    var jsonData = pm.response.json();",
							"    if (jsonData.results.length > 0) {",
							"        var item = jsonData.results[0];",
							"        pm.expect(item).to.have.property('id');",
							"        pm.expect(item).to.have.property('text');",
							"    }",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "http://localhost/oitava/agenda/buscar_convenios.php?busca=SUS",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"path": [
						"oitava",
						"agenda",
						"buscar_convenios.php"
					],
					"query": [
						{
							"key": "busca",
							"value": "SUS",
							"description": "Termo de busca (nome do convênio)"
						}
					]
				},
				"description": "Busca convênios pelo nome. Retorna até 15 resultados que contenham o termo buscado."
			},
			"response": [
				{
					"name": "Exemplo - Busca SUS",
					"originalRequest": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost/oitava/agenda/buscar_convenios.php?busca=SUS",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"path": [
								"oitava",
								"agenda",
								"buscar_convenios.php"
							],
							"query": [
								{
									"key": "busca",
									"value": "SUS"
								}
							]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n    \"results\": [\n        {\n            \"id\": \"106\",\n            \"text\": \"SUS ASSU - id: 106\",\n            \"data-nome\": \"SUS ASSU\",\n            \"data-sindicato\": \"\"\n        },\n        {\n            \"id\": \"3\",\n            \"text\": \"SUS RESSONANCIA SECRETARIA DO ESTADO DA SAUDE PUBLICA/SESAP - id: 3\",\n            \"data-nome\": \"SUS RESSONANCIA SECRETARIA DO ESTADO DA SAUDE PUBLICA/SESAP\",\n            \"data-sindicato\": \"\"\n        }\n    ],\n    \"pagination\": {\n        \"more\": false\n    },\n    \"total\": 2\n}"
				}
			]
		},
		{
			"name": "Buscar Convênio por ID",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code é 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Resposta contém resultados\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.results).to.be.an('array');",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "http://localhost/oitava/agenda/buscar_convenios.php?busca=962",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"path": [
						"oitava",
						"agenda",
						"buscar_convenios.php"
					],
					"query": [
						{
							"key": "busca",
							"value": "962",
							"description": "ID do convênio"
						}
					]
				},
				"description": "Busca convênio pelo ID numérico."
			},
			"response": [
				{
					"name": "Exemplo - Busca por ID",
					"originalRequest": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost/oitava/agenda/buscar_convenios.php?busca=962",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"path": [
								"oitava",
								"agenda",
								"buscar_convenios.php"
							],
							"query": [
								{
									"key": "busca",
									"value": "962"
								}
							]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n    \"results\": [\n        {\n            \"id\": \"962\",\n            \"text\": \"AMIL  (PARNAMIRIM) - id: 962\",\n            \"data-nome\": \"AMIL  (PARNAMIRIM)\",\n            \"data-sindicato\": \"\"\n        }\n    ],\n    \"pagination\": {\n        \"more\": false\n    },\n    \"total\": 1\n}"
				}
			]
		},
		{
			"name": "Buscar Convênio - Amil",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code é 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Retorna convênios Amil\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.results.length).to.be.greaterThan(0);",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "http://localhost/oitava/agenda/buscar_convenios.php?busca=AMIL",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"path": [
						"oitava",
						"agenda",
						"buscar_convenios.php"
					],
					"query": [
						{
							"key": "busca",
							"value": "AMIL",
							"description": "Nome do convênio"
						}
					]
				},
				"description": "Exemplo de busca para convênios Amil."
			},
			"response": []
		},
		{
			"name": "Buscar Convênio - Unimed",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "http://localhost/oitava/agenda/buscar_convenios.php?busca=UNIMED",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"path": [
						"oitava",
						"agenda",
						"buscar_convenios.php"
					],
					"query": [
						{
							"key": "busca",
							"value": "UNIMED",
							"description": "Nome do convênio"
						}
					]
				},
				"description": "Exemplo de busca para convênios Unimed."
			},
			"response": []
		},
		{
			"name": "Buscar Convênio - Particular",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "http://localhost/oitava/agenda/buscar_convenios.php?busca=PARTICULAR",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"path": [
						"oitava",
						"agenda",
						"buscar_convenios.php"
					],
					"query": [
						{
							"key": "busca",
							"value": "PARTICULAR",
							"description": "Busca por pagamento particular"
						}
					]
				},
				"description": "Busca por convênios com modalidade particular."
			},
			"response": []
		},
		{
			"name": "Buscar Convênio - Busca Vazia",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code é 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Retorna mensagem padrão para busca vazia\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.results).to.be.an('array');",
							"    pm.expect(jsonData.results.length).to.be.greaterThan(0);",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "http://localhost/oitava/agenda/buscar_convenios.php?busca=",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"path": [
						"oitava",
						"agenda",
						"buscar_convenios.php"
					],
					"query": [
						{
							"key": "busca",
							"value": "",
							"description": "Busca vazia - retorna convênios padrão"
						}
					]
				},
				"description": "Quando a busca está vazia, retorna alguns convênios padrão (PARTICULAR) e uma mensagem para o usuário digitar."
			},
			"response": [
				{
					"name": "Exemplo - Busca Vazia",
					"originalRequest": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost/oitava/agenda/buscar_convenios.php?busca=",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"path": [
								"oitava",
								"agenda",
								"buscar_convenios.php"
							],
							"query": [
								{
									"key": "busca",
									"value": ""
								}
							]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n    \"results\": [\n        {\n            \"id\": \"1\",\n            \"text\": \"PARTICULAR - id: 1\"\n        },\n        {\n            \"id\": \"0\",\n            \"text\": \"Digite para buscar convênios...\"\n        }\n    ],\n    \"pagination\": {\n        \"more\": false\n    },\n    \"total\": 2\n}"
				}
			]
		},
		{
			"name": "Buscar Convênio via POST",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code é 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Aceita POST com busca\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.results).to.be.an('array');",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/x-www-form-urlencoded"
					}
				],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "busca",
							"value": "CARTAO",
							"description": "Termo de busca",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "http://localhost/oitava/agenda/buscar_convenios.php",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"path": [
						"oitava",
						"agenda",
						"buscar_convenios.php"
					]
				},
				"description": "Exemplo de busca via POST (aceita tanto GET quanto POST)."
			},
			"response": []
		},
		{
			"name": "Buscar Convênio com Acentuação",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "http://localhost/oitava/agenda/buscar_convenios.php?busca=TERCEIRIZAÇÃO",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"path": [
						"oitava",
						"agenda",
						"buscar_convenios.php"
					],
					"query": [
						{
							"key": "busca",
							"value": "TERCEIRIZAÇÃO",
							"description": "Teste de busca com acentuação"
						}
					]
				},
				"description": "Testa busca com caracteres acentuados. O endpoint possui correção automática de encoding."
			},
			"response": []
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Script global executado antes de cada request"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Testes globais para todas as requests",
					"pm.test(\"Response time is less than 3000ms\", function () {",
					"    pm.expect(pm.response.responseTime).to.be.below(3000);",
					"});",
					"",
					"pm.test(\"Content-Type é application/json\", function () {",
					"    pm.response.to.have.header(\"Content-Type\");",
					"    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");",
					"});"
				]
			}
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost/oitava/agenda",
			"type": "string"
		},
		{
			"key": "endpoint",
			"value": "buscar_convenios.php",
			"type": "string"
		}
	]
}
